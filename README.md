私人图床系统 - 使用说明

项目简介

私人图床系统是一个基于PHP开发的图片托管平台，具有简洁的黑白设计风格和安全的TOTP双重验证功能。系统支持拖拽上传、图片预览、链接复制等功能，适合个人或小团队使用。

功能特点

· 🖼️ 图片上传：支持拖拽和点击上传
· 🔒 安全访问：TOTP双重验证保护
· 📱 响应式设计：适配各种设备屏幕
· 🎨 黑白风格：简洁优雅的视觉设计
· 🔗 一键复制：快速复制图片链接
· 📋 图片库管理：查看所有已上传图片
· ⚡ 实时预览：上传后立即预览图片

系统要求

· PHP 5.6+（推荐PHP 7.0+）
· FTP扩展支持
· 支持会话管理
· 现代浏览器支持

安装部署

1. 文件准备

将以下文件上传到你的Web服务器：

· index.php - 主程序文件（包含TOTP验证）
· upload.php - 图片上传处理
· gallery.php - 图片库显示

2. 配置FTP连接

编辑 upload.php 和 gallery.php 文件，修改FTP配置部分：

```php
$ftp_config = array(
    'host' => '你的FTP主机地址',      // 例如: ftp.example.com
    'user' => '你的FTP用户名',        // FTP用户名
    'pass' => '你的FTP密码',          // FTP密码
    'dir'  => '你的FTP图片目录',      // 例如: /public_html/images/
    'url'  => '你的网站域名'          // 例如: https://jzytc.ct.ws
);
```

重要提示：

· dir 是图片实际上传到FTP的目录
· url 是图片访问的域名，生成的链接格式为 域名/图片名

3. 配置TOTP验证

编辑 index.php 文件，设置TOTP密钥：

```php
$totp_secret = '你的TOTP密钥'; // 替换为你的Base32编码密钥
```

TOTP设置指南

生成TOTP密钥

1. 使用命令行工具：
   ```bash
   # 生成随机Base32密钥
   openssl rand -base64 20 | base32
   ```
2. 使用在线生成器：
   · 访问 TOTP密钥生成器
   · 生成并复制Base32密钥

配置身份验证器

1. 安装身份验证器应用：
   · Google Authenticator
   · Microsoft Authenticator
   · Authy
   · 或其他支持TOTP的应用
2. 添加新账户：
   · 选择"扫描二维码"或"手动输入"
   · 输入账户名称（如"图床系统"）
   · 输入TOTP密钥
   · 保存设置

使用说明

首次访问

1. 打开图床系统首页
2. 在身份验证器应用中获取6位验证码
3. 输入验证码完成身份验证
4. 系统会记住登录状态30分钟

上传图片

1. 拖拽上传：直接将图片文件拖到上传区域
2. 点击上传：点击"选择图片"按钮选择文件
3. 支持格式：JPG、PNG、GIF、BMP、WebP
4. 大小限制：单个文件不超过5MB

管理图片

· 查看图片库：页面底部显示所有已上传图片
· 复制链接：点击图片卡片的"复制链接"按钮
· 图片预览：上传后自动显示预览图

安全退出

点击右上角"退出登录"按钮，立即结束会话。

故障排除

常见问题

1. TOTP验证失败
   · 检查服务器时间是否准确
   · 确认TOTP密钥输入正确
   · 尝试前后30秒内的验证码
2. 图片上传失败
   · 检查FTP配置信息
   · 确认FTP目录存在且有写入权限
   · 检查文件大小是否超过限制
3. 图片链接无法访问
   · 确认网站域名配置正确
   · 检查图片是否成功上传到FTP
   · 验证网站根目录配置
4. 中文乱码问题
   · 确保所有文件使用UTF-8编码
   · 检查服务器字符集设置

日志查看

如需调试，可在PHP文件中添加错误日志：

```php
error_log('调试信息: ' . $variable);
```

查看服务器错误日志定位问题。

安全建议

1. 定期更换TOTP密钥
2. 使用强密码保护FTP账户
3. 限制图片上传大小
4. 定期检查系统日志
5. 保持PHP版本更新

文件结构

```
图床系统/
├── index.php          # 主程序文件（含TOTP验证）
├── upload.php         # 图片上传处理
├── gallery.php        # 图片库显示
└── README.md          # 说明文档
```

技术支持

如遇问题，请检查：

1. PHP错误日志
2. FTP连接状态
3. 文件权限设置
4. 服务器配置

版本信息

· 当前版本：v1.0
· 更新日期：2024年1月
· 兼容性：PHP 5.6+

---

注意：请妥善保管TOTP密钥和FTP登录信息，避免泄露造成安全风险。